2025-04-04 22:06:38,320 INFO: Attempting to upload avatar for influencer testinfluencer [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:336]
2025-04-04 22:06:38,942 ERROR: Storage upload failed: Header value must be str or bytes, not <class 'bool'> [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:351]
2025-04-04 22:11:09,094 INFO: Attempting to upload avatar for influencer testinfluencer [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:336]
2025-04-04 22:11:09,941 ERROR: Storage upload failed: {'statusCode': 403, 'error': Unauthorized, 'message': new row violates row-level security policy} [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:351]
Traceback (most recent call last):
  File "C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\venv\Lib\site-packages\storage3\_sync\file_api.py", line 53, in _request
    response.raise_for_status()
  File "C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\venv\Lib\site-packages\httpx\_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://iqeljrdbxweqyflitlrr.supabase.co/storage/v1/object/influencer-assets/avatars/original_testinfluencer_download.jpg'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py", line 341, in create_avatar
    upload_response = supabase.storage.from_(bucket_name).upload(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\venv\Lib\site-packages\storage3\_sync\file_api.py", line 535, in upload
    return self._upload_or_update("POST", path, file, file_options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\venv\Lib\site-packages\storage3\_sync\file_api.py", line 508, in _upload_or_update
    response = self._request(
               ^^^^^^^^^^^^^^
  File "C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\venv\Lib\site-packages\storage3\_sync\file_api.py", line 56, in _request
    raise StorageApiError(resp["message"], resp["error"], resp["statusCode"])
storage3.exceptions.StorageApiError: {'statusCode': 403, 'error': Unauthorized, 'message': new row violates row-level security policy}
2025-04-04 22:14:54,366 INFO: Attempting to upload avatar for influencer testinfluencer [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:336]
2025-04-04 22:14:54,921 ERROR: Storage upload failed: SyncBucketActionsMixin.upload() got an unexpected keyword argument 'headers' [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:354]
Traceback (most recent call last):
  File "C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py", line 341, in create_avatar
    upload_response = supabase.storage.from_(bucket_name).upload(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: SyncBucketActionsMixin.upload() got an unexpected keyword argument 'headers'
2025-04-04 22:16:35,008 ERROR: Avatar creation failed: 'SyncStorageClient' object has no attribute 'auth' [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:360]
2025-04-04 22:19:31,042 ERROR: Avatar creation failed: Header value must be str or bytes, not <class 'bool'> [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:349]
2025-04-04 22:22:15,376 ERROR: Avatar creation failed: SyncBucketActionsMixin.upload() got an unexpected keyword argument 'upsert' [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:351]
2025-04-04 22:23:52,505 ERROR: Avatar creation failed: {'statusCode': 403, 'error': Unauthorized, 'message': new row violates row-level security policy} [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:361]
2025-04-04 22:25:54,538 ERROR: Upload error: {'statusCode': 403, 'error': Unauthorized, 'message': new row violates row-level security policy} [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:367]
2025-04-04 22:35:24,845 ERROR: Upload error: {'statusCode': 413, 'error': Payload too large, 'message': The object exceeded the maximum allowed size} [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:361]
2025-04-04 22:36:19,609 ERROR: Upload error: {'statusCode': 413, 'error': Payload too large, 'message': The object exceeded the maximum allowed size} [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:361]
2025-04-05 09:16:21,339 ERROR: Avatar creation failed: name 'secure_filename' is not defined [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:488]
2025-04-05 09:24:07,256 ERROR: HeyGen avatar creation failed: <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:427]
2025-04-05 09:27:37,696 ERROR: Upload error: {'statusCode': 409, 'error': Duplicate, 'message': The resource already exists} [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:482]
2025-04-05 09:28:26,055 ERROR: HeyGen avatar creation failed: <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:427]
2025-04-05 09:33:30,127 ERROR: HeyGen avatar creation failed: <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:427]
2025-04-05 10:03:48,300 ERROR: HeyGen API error: 0 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:469]
2025-04-05 10:08:55,090 INFO: Using HeyGen API key: YTExM...3Ng== [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:418]
2025-04-05 10:08:55,090 INFO: Attempting to connect to HeyGen API... [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:422]
2025-04-05 10:09:01,100 INFO: HeyGen API response status: 200 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:429]
2025-04-05 10:09:01,102 INFO: HeyGen API response body: {"error": null, "data": {"avatars": [{"avatar_id": "0019574bacd74bd9a2cb76ac19bfb773", "avatar_name": "Ademola", "gender": "unknown", "preview_image_url": "https://files2.heygen.ai/avatar/v3/0019574bacd74bd9a2cb76ac19bfb773/full/2.2/preview_target.webp", "preview_video_url": "https://files2.heygen.ai/avatar/v3/0019574bacd74bd9a2cb76ac19bfb773/full/2.2/preview_video_target.mp4", "premium": false, "type": null, "tags": null}, {"avatar_id": "0019574bacd74bd9a2cb76ac19bfb773", "avatar_name": "Ademol [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:430]
2025-04-05 10:09:01,118 ERROR: HeyGen API error: 0 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:490]
2025-04-05 10:17:15,731 INFO: Attempting to connect to HeyGen API... [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:420]
2025-04-05 10:17:21,533 INFO: HeyGen API response status: 200 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:429]
2025-04-05 10:17:21,548 ERROR: HeyGen API error: 0 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:481]
2025-04-05 10:17:21,551 ERROR: Traceback (most recent call last):
  File "C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py", line 458, in create_avatar
    avatar_id = avatars[0].get("avatar_id")
                ~~~~~~~^^^
KeyError: 0
 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:482]
2025-04-05 10:22:46,381 INFO: Attempting to connect to HeyGen API... [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:419]
2025-04-05 10:23:12,941 INFO: Using HeyGen avatar: 0019574bacd74bd9a2cb76ac19bfb773 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:459]
2025-04-09 10:44:47,242 INFO: Attempting to connect to HeyGen API... [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:415]
2025-04-09 10:45:18,995 INFO: Using HeyGen avatar: 0019574bacd74bd9a2cb76ac19bfb773 [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:455]
2025-04-09 10:52:14,848 ERROR: Speech to text error: [WinError 32] The process cannot access the file because it is being used by another process: 'C:\\Users\\ELITEB~1\\AppData\\Local\\Temp\\tmp2gfypx8i.mp3' [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:722]
2025-04-09 10:57:31,494 ERROR: Text to speech error: Chatbot.generate_voice_audio() takes from 2 to 3 positional arguments but 4 were given [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:766]
2025-04-09 11:01:01,014 ERROR: Text to speech error: 'Chatbot' object has no attribute 'generate_voice_audio' [in C:\Users\ELITEBOOK\OneDrive\Desktop\Projects\AvatarCommerce\app\main.py:766]
